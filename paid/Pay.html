<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ƒê√≥ng ƒëo√†n ph√≠</title>
<style>
  body { margin:0; padding:0; font-family:"Segoe UI"; background:#0d0d0d; color:#f8f9fa; text-align:center; }
  h2 { margin:30px 0 20px; color:#ff85c0; text-shadow:0 0 15px rgba(255,133,192,0.8); }
  #loading { margin:20px 0; font-size:18px; color:#ff85c0; animation: blink 1s infinite; }
  @keyframes blink { 50% { opacity:0.5; } }
  #studentList { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,220px)); gap:20px; justify-content:center; max-width:1000px; margin:0 auto; padding:20px; }
  @media (min-width:768px){ #studentList{grid-template-columns:repeat(3,1fr);} }
  @media (max-width:500px){ #studentList{grid-template-columns:1fr;} }
  .student { background:rgba(255,255,255,0.05); border-radius:12px; padding:15px; cursor:pointer; transition:all 0.25s ease; font-weight:500; backdrop-filter:blur(4px); border:2px solid transparent; }
  .student:hover { transform:translateY(-5px) scale(1.02); background:rgba(255,255,255,0.1); box-shadow:0 4px 15px rgba(255,133,192,0.4); }
  .student.disabled { background:rgba(0,128,0,0.2); border:2px solid #28a745; color:#aaffaa; cursor:not-allowed; box-shadow:none; }
  .student.unpaid { background:rgba(128,0,0,0.2); border:2px solid #dc3545; color:#ff9999; }

  /* Popup */
  /* Popup */
  #popup { 
      display:none; 
      position:fixed; 
      top:50%; left:50%; 
      transform:translate(-50%,-50%); 
      background:#111; 
      padding:30px; 
      border-radius:20px; 
      box-shadow:0 0 30px rgba(255,133,192,0.5); 
      width:90%; 
      max-width:500px; 
      max-height:90%; 
      overflow-y:auto; 
      text-align:center; 
      z-index:999; 
  }

  #popup h3 { 
      color:#ff85c0; 
      margin-bottom:20px; 
  }

  #popup img { 
      display:block; 
      margin:0 auto 20px auto; 
      width:250px; 
      max-width:80%; 
      height:auto; 
  }

  #popup p { 
      margin:8px 0; 
      font-size:16px;
  }

  /* N√∫t X g√≥c tr√™n */
  #closeBtn {
      position:absolute;
      top:10px;
      right:10px;
      background:none;
      border:none;
      font-size:22px;
      color:#ff85c0;
      cursor:pointer;
  }



  #paidBtn {
      display:block;
      margin:15px auto 0 auto;
      padding:12px 20px;
      border:none;
      border-radius:12px;
      background:linear-gradient(45deg,#ff4da6,#ff85c0);
      color:white;
      font-weight:bold;
      cursor:pointer;
      transition:all 0.3s ease;
  }
  #paidBtn:hover {
      background:linear-gradient(45deg,#ff85c0,#ff4da6);
      transform:scale(1.05);
  }
  /* QR zoom fullscreen */
  #qrZoom {
      display:none;
      position:fixed;
      top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.85);
      justify-content:center;
      align-items:center;
      z-index:1000;
  }
  #qrZoom img {
      max-width:90%;
      max-height:90%;
      border-radius:15px;
      box-shadow:0 0 30px rgba(255,133,192,0.7);
      cursor:zoom-out;
  }


</style>
</head>
<body>

<h2>‚ú® Danh s√°ch h·ªçc sinh ƒëo√†n ph√≠ 11A6</h2>
<p id="loading">‚è≥ ƒêang t·∫£i danh s√°ch...</p>
<div id="studentList"></div>

<!-- Popup th√¥ng tin thanh to√°n -->
<div id="popup">
  <button id="closeBtn" onclick="closePopup()">‚úñ</button>
  <h3>Th√¥ng tin thanh to√°n</h3>
  <img id="qrImage" src="" alt="QR Code" onclick="zoomQR(this)">
  <p><strong>Ng√¢n H√†ng:</strong> MB Bank</p>
  <p><strong>Ch·ªß T√†i Kho·∫£n:</strong> DAO DUY PHAT</p>
  <p><strong>S·ªë T√†i Kho·∫£n:</strong> 0343406068</p>
  <p><strong>S·ªë ti·ªÅn:</strong> 11.000ƒë</p>
  <p><strong>N·ªôi Dung:</strong> <span id="popupName"></span></p>
  <button id="paidBtn" onclick="markPaid()">üí≥ T√¥i ƒë√£ ho√†n t·∫•t thanh to√°n tr√™n app</button>
</div>

<!-- Lightbox QR fullscreen -->
<div id="qrZoom" onclick="closeZoom()">
  <img id="qrZoomImg" src="" alt="QR Code Fullscreen">
</div>



<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyZ7BT6Uo1snIiBB0bXH5DvipBLRkTFKryRmzaE-0WXFXO8LHuEmpSVwPLHxRnRIXZ4zA/exec";

function showPopup(studentName){
    const popup = document.getElementById("popup");
    document.getElementById("popupName").innerText = studentName;
    document.getElementById("qrImage").src = `https://img.vietqr.io/image/MB-0343406068-compact2.png?amount=11000&addInfo=${encodeURIComponent(studentName)}`;
    popup.style.display = "block";
}

function zoomQR(img){
    const zoom = document.getElementById("qrZoom");
    const zoomImg = document.getElementById("qrZoomImg");
    zoomImg.src = img.src;
    zoom.style.display = "flex";
}

function closeZoom(){
    document.getElementById("qrZoom").style.display = "none";
}


function markPaid(){
    const popup = document.getElementById("popup");
    popup.innerHTML = `<button id="closeBtn" onclick="closePopup()">‚úñ</button>
                       <h3>Ch·ªù x√©t duy·ªát</h3>
                       <p>Thanh to√°n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n, vui l√≤ng ch·ªù x√©t duy·ªát.</p>`;
}


function closePopup(){
    document.getElementById("popup").style.display = "none";
}

// Load danh s√°ch h·ªçc sinh
fetch(API_URL + "?action=get")
.then(res => res.json())
.then(data => {
    document.getElementById("loading").style.display = "none";
    const container = document.getElementById("studentList");

    data.forEach((stu, index) => {
        const div = document.createElement("div");
        div.className = "student";

        if(stu.status === "Paid"){
            div.classList.add("disabled");
            div.innerHTML = `<div><strong>STT:</strong> ${stu.stt}</div>
                             <div><strong>H·ªç t√™n:</strong> ${stu.name}</div>
                             <div><strong>L·ªõp:</strong> 11A6</div>
                             <div><strong>Tr·∫°ng th√°i:</strong> ‚úÖ ƒê√£ ƒë√≥ng</div>`;
        } else {
            div.classList.add("unpaid");
            div.innerHTML = `<div><strong>STT:</strong> ${stu.stt}</div>
                             <div><strong>H·ªç t√™n:</strong> ${stu.name}</div>
                             <div><strong>L·ªõp:</strong> 11A6</div>
                             <div><strong>Tr·∫°ng th√°i:</strong> ‚è≥ Ch∆∞a ƒë√≥ng</div>`;
            div.addEventListener("click", ()=> showPopup(stu.name));
        }

        container.appendChild(div);
    });
});
</script>

</body>
</html>
